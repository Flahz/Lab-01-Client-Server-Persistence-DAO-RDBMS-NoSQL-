<?xml version="1.0" encoding="UTF-8" ?>
<configure xmlns="http://schemas.xmlsoap.org/encoding/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://schemas.xmlsoap.org/encoding/ ConfigXMLSchema.xsd">
    <fileGroup treeRootName="Cisco Secure Client" directoryName="Cisco Secure Client\DART">
        <title>DART</title>
        <file id="csc-dart-logs" directoryName="Logs">
            <default>true</default>
            <description>Application logs</description>
            <gui>
                <label>_tr("Application logs")</label>
                <file_type>log</file_type>
            </gui>
            <dart>
                <required>false</required>
                <os opsys="win">
                    <use_extern_action>
                        <action>
                            <plugin/>
                            <args>wineventlog.exe -l "Cisco Secure Client - Diagnostics and Reporting Tool" -f %TEMP%\CiscoSecureClient-DART.txt</args>
                            <clear_log apply="false"/>
                            <temp_out>%TEMP%\CiscoSecureClient-DART.txt</temp_out>
                        </action>
                        <action>
                            <path>%WINDIR%\System32</path>
                            <args>wevtutil epl "Cisco Secure Client - Diagnostics and Reporting Tool" %TEMP%\CiscoSecureClient-DART.evtx</args>
                            <clear_log apply="true">wevtutil cl "Cisco Secure Client - Diagnostics and Reporting Tool"</clear_log>
                            <temp_out>%TEMP%\CiscoSecureClient-DART.evtx</temp_out>
                        </action>
                    </use_extern_action>
                </os>
                <os opsys="mac">
                    <use_extern_action>
                        <action>
                            <path>/usr/bin</path>
                            <args>log show --predicate 'subsystem contains "com.cisco.secureclient.vpn" AND category IN { "csc_dartcli", "csc_dartui", "csc_darthelper" }' --debug --info --last 1d</args>
                            <clear_log apply="false"/>
                            <stdout/>
                            <temp_out>CiscoSecureClient-DART.log</temp_out>
                        </action>
                    </use_extern_action>
                </os>
                <os opsys="linux">
                    <use_extern_action>
                        <action>
                            <args>journalctl -S -1d -t csc_dartui -t csc_dartcli -t csc_darthelper</args>
                            <clear_log apply="false"/>
                            <stdout/>
                            <temp_out>CiscoSecureClient-DART.log</temp_out>
                        </action>
                    </use_extern_action>
                    <use_extern_action>
                        <action>
                            <args>journalctl -o export -S -1d -t csc_dartui -t csc_dartcli -t csc_darthelper</args>
                            <clear_log apply="false"/>
                            <stdout/>
                            <temp_out>CiscoSecureClient-DART.logexport</temp_out>
                        </action>
                    </use_extern_action>
                </os>
            </dart>
        </file>
        <file id="csc-dart-install" directoryName="Install Logs">
            <default>true</default>
            <description>Install logs</description>
            <gui>
                <label>_tr("Install logs")</label>
                <file_type>log</file_type>
            </gui>
            <dart>
                <required>false</required>
                <os opsys="win">
                    <file_copy_action>
                        <action>
                            <loc>%TEMP%\cisco-secure-client*-dart-*.log</loc>
                            <clear_log apply="false"/>
                        </action>
                        <action>
                            <loc>%WINDIR%\Temp\cisco-secure-client*-dart-*.log</loc>
                            <clear_log apply="false"/>
                        </action>
                    </file_copy_action>
                </os>
                <os opsys="linux">
                    <file_copy_action>
                        <action>
                            <loc>/opt/cisco/secureclient/dart/cisco-secure-client*-dart-*.log</loc>
                            <clear_log apply="false"/>
                        </action>
                    </file_copy_action>
                </os>
            </dart>
        </file>
    </fileGroup>

    <fileGroup treeRootName="Legacy - Cisco AnyConnect Secure Mobility Client" directoryName="Legacy - Cisco AnyConnect Secure Mobility Client\Cisco AnyConnect DART">
        <title>Cisco AnyConnect DART</title>
        <file id="ac-dart-logs">
            <default>false</default>
            <description>DART application logs</description>
            <gui>
                <label>_tr("DART application logs")</label>
                <file_type>log</file_type>
            </gui>
            <dart>
                <required>false</required>
                <os opsys="win">
                    <use_extern_action>
                        <action>
                            <plugin/>
                            <args>wineventlog.exe -l "Cisco AnyConnect Diagnostics and Reporting Tool" -f %TEMP%\DART.txt</args>
                            <clear_log apply="false"/>
                            <temp_out>%TEMP%\DART.txt</temp_out>
                        </action>
                        <action>
                            <path>%WINDIR%\System32</path>
                            <args>wevtutil epl "Cisco AnyConnect Diagnostics and Reporting Tool" %TEMP%\DART.evtx</args>
                            <clear_log apply="true">wevtutil cl "Cisco AnyConnect Diagnostics and Reporting Tool"</clear_log>
                            <temp_out>%TEMP%\DART.evtx</temp_out>
                        </action>
                    </use_extern_action>
                </os>
                <os opsys="mac">
                    <use_extern_action>
                        <action>
                            <path>/usr/bin</path>
                            <args>log show --predicate 'subsystem contains "com.cisco.anyconnect.vpn" AND category IN { "acdartcli", "acdartui", "acdarthelper" }' --debug --info --last 1d</args>
                            <clear_log apply="false"/>
                            <stdout/>
                            <temp_out>DART.log</temp_out>
                        </action>
                    </use_extern_action>
                </os>
                <os opsys="linux">
                    <use_extern_action>
                        <action>
                            <args>journalctl -S -1d -t acdartui -t acdartcli -t acdarthelper</args>
                            <clear_log apply="false"/>
                            <stdout/>
                            <temp_out>DART.log</temp_out>
                        </action>
                    </use_extern_action>
                    <use_extern_action>
                        <action>
                            <args>journalctl -o export -S -1d -t acdartui -t acdartcli -t acdarthelper</args>
                            <clear_log apply="false"/>
                            <stdout/>
                            <temp_out>DART.logexport</temp_out>
                        </action>
                    </use_extern_action>
                </os>
            </dart>
        </file>
        <file id="ac-dart-install">
            <default>false</default>
            <description>DART install logs</description>
            <gui>
                <label>_tr("DART install logs")</label>
                <file_type>log</file_type>
            </gui>
            <dart>
                <required>false</required>
                <os opsys="win">
                    <file_copy_action>
                        <action>
                            <loc>%TEMP%\anyconnect*-dart-*.log</loc>
                            <clear_log apply="false"/>
                        </action>
                        <action>
                            <loc>%WINDIR%\Temp\anyconnect*-dart-*.log</loc>
                            <clear_log apply="false"/>
                        </action>
                    </file_copy_action>
                </os>
                <os opsys="linux">
                    <file_copy_action>
                        <action>
                            <loc>/opt/cisco/anyconnect/dart/anyconnect*-dart-*.log</loc>
                            <clear_log apply="false"/>
                        </action>
                    </file_copy_action>
                </os>
            </dart>
        </file>
    </fileGroup>
</configure>
